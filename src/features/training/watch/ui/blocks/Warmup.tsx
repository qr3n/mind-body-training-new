import { IWatchTrainingBlockProps } from "@/features/training/watch/ui/blocks/types";
import { WatchTrainingTemplate } from "@/features/training/watch/ui/templates";
import { AnimatePresence, motion } from "framer-motion";
import { useCurrentBlockStep }      from "@/features/training/watch/model/useCurrentBlockStep";
import { Phrase } from "@/features/training/watch/ui/blocks/Phrase";
import { ITrainingBlockWithContent } from "@/entities/training";
import { getTrainingLabel } from "@/shared/utils/getTrainingLabel";

interface Block extends ITrainingBlockWithContent {
    exerciseNumber?: number;
    circleNumber?: number;
}
export const Warmup = (props: IWatchTrainingBlockProps) => {
    const { currentStep, handleNext , handlePrev } = useCurrentBlockStep(props)

    let exerciseCount = 0;

    const groupedBlocks = (props.block.content || []).reduce((acc: Block[][], block: Block, index: number, arr: Block[]) => {
        if (block.type === 'phrase') {
            acc.push([{ ...block }]); // Добавляем фразу как отдельную группу
            return acc;
        }

        if (block.type === 'rest' && arr[index + 1]?.type === 'exercise') {
            exerciseCount++;
            acc.push([
                { ...block, exerciseNumber: exerciseCount },
                { ...arr[index + 1], exerciseNumber: exerciseCount }
            ]);
        } else if (block.type === 'exercise' && (index === 0 || arr[index - 1]?.type !== 'rest')) {
            exerciseCount++;
            acc.push([{ ...block, exerciseNumber: exerciseCount }]);
        } else if (block.type === 'rest') {
            acc.push([{ ...block }]); // Добавляем отдельно стоящий отдых
        }

        return acc;
    }, []);

    console.log(groupedBlocks)

    const exercisesCount = groupedBlocks.length;

    const staticBlock = [
        <WatchTrainingTemplate.BlockText
            handlePrev={handlePrev}
            icon={<svg className='max-w-[23vh] max-h-[23vh]' xmlns="http://www.w3.org/2000/svg" xlinkHref="http://www.w3.org/1999/xlink" width="150"
                       height="150" viewBox="0 0 256 256" fill="none">
                <rect width="256" height="256" fill="url(#pattern0_10_2)"/>
                <defs>
                    <pattern id="pattern0_10_2" patternContentUnits="objectBoundingBox" width="1" height="1">
                        <use xlinkHref="#image0_10_2" transform="scale(0.00390625)"/>
                    </pattern>
                    <image id="image0_10_2" width="256" height="256"
                           xlinkHref="data:image/png;base64,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"/>
                </defs>
            </svg>}
            handleNext={handleNext} key={0} text="Разминка!">
            <WatchTrainingTemplate.BlockSounds nextAfterComplete handleNext={handleNext} isPlaying block={props.block}/>
            <div className="flex text-white items-center my-8 gap-8 justify-between">
                <div className="text-center flex justify-center items-center gap-3">
                    <h1 className="font-semibold text-5xl">
                        {props.block?.content?.filter((item) => item.type === "rest").length}
                    </h1>
                    <h1 className="font-medium text-[#eee]">{getTrainingLabel(props.block?.content?.filter((item) => item.type === "rest").length || 0)}</h1>
                </div>
            </div>
        </WatchTrainingTemplate.BlockText>,
    ];


    const dynamicBlocks = groupedBlocks.map((group, i) =>
        group.map((b: Block) =>
            b.type === 'phrase' ? (
                <Phrase key={b.id || Date.now().toString()} prevStep={handlePrev} block={b} onComplete={handleNext} step={props.step} />
            ) : (
                <WatchTrainingTemplate.BlockVideos
                    restType={b.type === 'rest' ? (i < 2 ? 'first' : 'second') : undefined}
                    handlePrev={handlePrev}
                    renderExerciseNumber
                    handleNext={handleNext}
                    key={b.id || Date.now().toString()}
                    exerciseNumber={b.exerciseNumber}
                    exercisesCount={exercisesCount}
                    block={b}
                    type={b.type}
                />
            )
        )
    ).flat();

    const blocks = [...staticBlock, ...(dynamicBlocks || [])];

    return (
        <motion.div
            initial={{opacity: 0, x: -100}}
            animate={{opacity: 1, x: 0}}
            exit={{opacity: 0, x: 100}}
            transition={{duration: 0.1}}
        >
            <AnimatePresence mode="wait">
                {blocks[currentStep]}
            </AnimatePresence>
        </motion.div>
    );
};
